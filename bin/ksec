#!/usr/bin/env bash

set -euo pipefail

function main() {
  local secret_name
  local secret_key

  secret_name="$(kubectl get secret -o json | jq -r '.items[].metadata.name' | fzf --preview='kubectl describe secret {}')"
  secret_key="$(kubectl get secret "${secret_name}" -o json | jq -r '.data | keys[]' | fzf)"
  kubectl get secret "${secret_name}" -o json | jq -r ".data.\"${secret_key}\"" | base64 --decode
}

main
